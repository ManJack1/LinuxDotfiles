const t=t=>{if(t.ok)return t.text();throw new Error},requestSubtitleList=n=>fetch(`https://www.youtube.com/watch?v=${n}`).then(t).then((t=>(new window.DOMParser).parseFromString(t,"text/html"))).then((t=>{const n=[...t.body.querySelectorAll(":scope > script")].find((t=>t.textContent.includes("ytInitialPlayerResponse")));return new Function(`${n.textContent}; return ytInitialPlayerResponse;`)()})),errorBackHandler=t=>{window.postMessage({source:"ext",type:"responseSubtitleResponse",text:!1}),t&&chrome.storage.sync.get("time",(({time:n})=>{if((Date.now()-n)/1e3/60/60>24){if(document.querySelector("#translationErrorBox"))return;const n=chrome.i18n.getMessage;document.body.insertAdjacentHTML("beforeend",`<div id="translationErrorBox" style="box-sizing:border-box;min-width:356px;white-space:nowrap;background:#202124;border-radius:4px;padding:18px;display:inline-block;font-family:Roboto,'Microsoft YaHei UI','Microsoft YaHei','Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,sans-serif;box-shadow:2px 4px 5px #00000042;z-index:3000;position:fixed;left:0;bottom:-18px;opacity:0;margin:12px;transition:all .3s"><style>#translationErrorBox #close:hover,#translationErrorBox #today:hover{background:rgba(63,196,255,.1)}</style><div style="color:#fff;font-size:16px">${2===t?`<div>${n("translationError")}</div><div style="font-size:13px;margin-top:8px;color:#ffffffcc">${n("translationErrorDetails")}</div>`:`<div>${n("requestError")}</div>`}</div><div style="margin-top:16px;font-size:14px;letter-spacing:.7px;color:#54b0ff;display:flex;justify-content:flex-end;user-select:none"><div id="today" style="padding:8px 16px;border-radius:3px;display:inline-flex;justify-content:center;align-items:center;transition:background 160ms;cursor:pointer">${n("today")}</div><div id="close" style="padding:8px 16px;border-radius:3px;display:inline-flex;justify-content:center;align-items:center;transition:background 160ms;cursor:pointer">${n("close")}</div></div></div>`),setTimeout((()=>{const t=document.querySelector("#translationErrorBox");t.style.setProperty("bottom","0"),t.style.setProperty("opacity","1");const n=()=>{t.style.setProperty("bottom","-18px"),t.style.setProperty("opacity","0"),setTimeout((()=>t.remove()),500)};t.querySelector("#close").addEventListener("click",n),t.querySelector("#today").addEventListener("click",(()=>{n(),chrome.storage.sync.set({time:Date.now()})}))}),30)}}))};let subtitleRequestXhrUrl="",n=!1;const standardCode=t=>{switch(!0){case["zh-CN","zh-SG","yue","nan","hak","zh"].includes(t):return"zh-Hans";case["zh-TW","zh-HK","yue-HK","nan-TW","hak-TW"].includes(t):return"zh-Hant";case["en-GB","en-US","en-IE","en-CA","en-IN"].includes(t):return"en";case["es-419","es-US","es-MX","es-ES"].includes(t):return"es";case["pt-BR","pt-PT"].includes(t):return"pt";case["hi-Latn"].includes(t):return"hi";case["sr-Latn","sr-Cyrl"].includes(t):return"sr";case["mo"].includes(t):return"ro";case["nl-BE","nl-NL"].includes(t):return"nl";case["fr-BE","fr-FR","fr-CA","fr-CH"].includes(t):return"fr";case["ru-Latn"].includes(t):return"ru";case["de-AT","de-DE","de-CH"].includes(t):return"de";case["fa-AF","fa-IR"].includes(t):return"fa";case["he"].includes(t):return"iw";default:return t}},e=32,o={500:.5,520:17/32,560:18/32,610:19/32,650:.625,700:21/32,760:22/32,830:23/32,900:.75,1014:21/32,1150:22/32,1200:23/32,1300:.75,1400:26/32,1500:.875,1600:30/32,1800:1,1910:1,fullscreen:47/32},i=Object.entries(o).map((([t,n])=>`@media (${"fullscreen"===t?"display-mode: fullscreen":`min-width: ${t}px`}) {:root { --ytScalingRatio: ${n};}}`)).join("\n");(document.head||document.documentElement).insertAdjacentHTML("afterbegin",'<style id="customSubtitleStyle"></style>\n  <style id="dualMarkStyle">\n  .ytp-settings-menu #language-button .ytp-menuitem-content {\n    position: relative !important;\n    padding-left: 20px !important;\n  }\n  .ytp-settings-menu #language-button .ytp-menuitem-content::before {\n    content: url(\'data:image/svg+xml;utf8,<svg width="20" height="12" viewBox="0 0 20 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.1312 1.2129L13.9183 0L8.46452 5.45376L9.67742 6.66667L15.1312 1.2129ZM18.7785 0L9.67742 9.10107L6.08172 5.51398L4.86882 6.72688L9.67742 11.5355L20 1.2129L18.7785 0ZM0 6.72688L4.8086 11.5355L6.02151 10.3226L1.22151 5.51398L0 6.72688Z" fill="%23eee" fill-opacity="0.92"/></svg>\');\n    position: absolute;\n    left: 0;\n  }\n  </style>\n  <style>\n  #ytp-caption-window-container .caption-window:not([lang])::before {\n    content: url(\'data:image/svg+xml;utf8,<svg width="94" height="31" viewBox="0 0 94 31" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 12L4 23C4 25.2091 5.79086 27 8 27H29.5C31.7091 27 33.5 25.2091 33.5 23V12C33.5 9.79086 31.7091 8 29.5 8H8C5.79086 8 4 9.79086 4 12Z" fill="black" fill-opacity="0.92"/><path fill-rule="evenodd" clip-rule="evenodd" d="M10 21.25C10 20.5596 10.5596 20 11.25 20C11.9404 20 12.5 20.5596 12.5 21.25C12.5 21.9404 11.9404 22.5 11.25 22.5C10.5596 22.5 10 21.9404 10 21.25ZM16.25 20C15.5596 20 15 20.5596 15 21.25C15 21.9404 15.5596 22.5 16.25 22.5C16.9404 22.5 17.5 21.9404 17.5 21.25C17.5 20.5596 16.9404 20 16.25 20ZM20 21.25C20 20.5596 20.5596 20 21.25 20C21.9404 20 22.5 20.5596 22.5 21.25C22.5 21.9404 21.9404 22.5 21.25 22.5C20.5596 22.5 20 21.9404 20 21.25ZM25 21.25C25 20.5596 25.5596 20 26.25 20C26.9404 20 27.5 20.5596 27.5 21.25C27.5 21.9404 26.9404 22.5 26.25 22.5C25.5596 22.5 25 21.9404 25 21.25ZM26.25 12.5C25.5596 12.5 25 13.0596 25 13.75C25 14.4404 25.5596 15 26.25 15C26.9404 15 27.5 14.4404 27.5 13.75C27.5 13.0596 26.9404 12.5 26.25 12.5ZM20 13.75C20 13.0596 20.5596 12.5 21.25 12.5C21.9404 12.5 22.5 13.0596 22.5 13.75C22.5 14.4404 21.9404 15 21.25 15C20.5596 15 20 14.4404 20 13.75ZM16.25 12.5C15.5596 12.5 15 13.0596 15 13.75C15 14.4404 15.5596 15 16.25 15C16.9404 15 17.5 14.4404 17.5 13.75C17.5 13.0596 16.9404 12.5 16.25 12.5ZM10 13.75C10 13.0596 10.5596 12.5 11.25 12.5C11.9404 12.5 12.5 13.0596 12.5 13.75C12.5 14.4404 11.9404 15 11.25 15C10.5596 15 10 14.4404 10 13.75Z" fill="white" fill-opacity="0.92"/></svg>\');\n    position: absolute;\n    left: -4px;\n    bottom: 100%;\n    margin-bottom: -2px;\n    opacity: 0;\n    transition: opacity 200ms;\n  }\n  #ytp-caption-window-container .caption-window:not([lang]):hover::before {\n    opacity: 1;\n  }\n  #ytp-caption-window-container .caption-window:not([lang]) {\n    outline: 0 !important;\n    width: max-content !important;\n    max-width: 95% !important;\n  }\n  #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line .ytp-caption-segment {\n    cursor: auto !important;\n    user-select: text !important;\n  }\n  .ytp-settings-menu .quality-button .ytp-menuitem-content {\n    position: relative !important;\n    padding-left: 20px !important;\n  }\n  .ytp-settings-menu .quality-button .ytp-menuitem-content #qualityIcon {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 20px;\n    height: 100%;\n  }\n  .ytp-settings-menu .quality-button .ytp-menuitem-content #qualityIcon::before {\n    content: url(\'data:image/svg+xml;utf8,<svg width="13" height="18" viewBox="0 0 13 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.5 13C7.39375 13 8.125 12.2688 8.125 11.375C8.125 10.4812 7.39375 9.75 6.5 9.75C5.60625 9.75 4.875 10.4812 4.875 11.375C4.875 12.2688 5.60625 13 6.5 13ZM11.375 5.6875H10.5625V4.0625C10.5625 1.82 8.7425 0 6.5 0C4.2575 0 2.4375 1.82 2.4375 4.0625V5.6875H1.625C0.73125 5.6875 0 6.41875 0 7.3125V15.4375C0 16.3313 0.73125 17.0625 1.625 17.0625H11.375C12.2688 17.0625 13 16.3313 13 15.4375V7.3125C13 6.41875 12.2688 5.6875 11.375 5.6875ZM3.98125 4.0625C3.98125 2.67312 5.11062 1.54375 6.5 1.54375C7.88938 1.54375 9.01875 2.67312 9.01875 4.0625V5.6875H3.98125V4.0625ZM11.375 15.4375H1.625V7.3125H11.375V15.4375Z" fill="%23eee" stroke-width="0.1" fill-opacity="0.92"/></svg>\');\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n  }\n  </style>\n  <style id="qualityUnlock">\n  .ytp-settings-menu .quality-button .ytp-menuitem-content #qualityIcon::before {\n    content: url(\'data:image/svg+xml;utf8,<svg width="19" height="19" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.6247 12.6438C13.6247 13.5412 12.8972 14.2688 11.9997 14.2688C11.1022 14.2688 10.3747 13.5412 10.3747 12.6438C10.3747 11.7463 11.1022 11.0188 11.9997 11.0188C12.8972 11.0188 13.6247 11.7463 13.6247 12.6438Z" fill="%23eee"/><path fill-rule="evenodd" clip-rule="evenodd" d="M2.46228 4.12084C2.68905 2.68535 4.00093 1.77227 5.409 1.77227C6.85551 1.77227 8.02813 2.94489 8.02813 4.3914V6.95625H7.12471C6.22725 6.95625 5.49971 7.68379 5.49971 8.58125V16.7062C5.49971 17.6037 6.22725 18.3312 7.12471 18.3312H16.8747C17.7722 18.3312 18.4997 17.6037 18.4997 16.7062V8.58125C18.4997 7.68379 17.7722 6.95625 16.8747 6.95625H9.57189V4.3914C9.57189 2.0923 7.7081 0.228516 5.409 0.228516C3.40041 0.228516 1.30596 1.54718 0.937436 3.87994C0.90791 4.06684 0.881282 4.22232 0.857826 4.35927C0.809297 4.64263 0.774351 4.84667 0.755432 5.08557C0.728007 5.4319 0.728013 5.89327 0.728028 6.92519V7.00039H2.27178C2.27178 5.87596 2.27246 5.48405 2.29436 5.20744C2.30782 5.03753 2.32682 4.92758 2.36476 4.70803C2.38865 4.56983 2.42004 4.38819 2.46228 4.12084ZM16.8747 8.58125H7.12471V16.7062H16.8747V8.58125Z" fill="%23eee"/></svg>\');\n  }\n  </style>\n  <style id="subtitleHandle"></style>\n  ');const subtitlesHandler=(()=>{const e=(()=>{const t=document.createElement("span");return n=>(t.innerHTML=n,t.textContent.trim())})(),o=(n,o)=>fetch(n).then(t).then((t=>(new window.DOMParser).parseFromString(t,"text/xml"))).then((t=>{const n=["zh-Hans","zh-Hant","zh-CN","zh-TW","zh-HK","zh","zh-SG","yue","nan","yue-HK","nan-TW","hak-TW","hak","ja","ko","th","km","lo","my"].includes(o)?"":" ",i=[...t.querySelectorAll("text")].map((t=>({tStartMs:Math.round(1e3*t.getAttribute("start")),dDurationMs:Math.round(1e3*t.getAttribute("dur")),utf8:e(t.textContent.replace(/\s*\n\s*/g,n))})));let a=[],r=i[0].tStartMs+i[0].dDurationMs,s={tStartMs:i[0].tStartMs,dDurationMs:i[0].dDurationMs};return i.reduce(((t,e,o)=>{if(e.tStartMs>=r){const o=a.join(n);t=t.concat({...s,segs:o}),r=e.tStartMs+e.dDurationMs,s={tStartMs:e.tStartMs,dDurationMs:e.dDurationMs},a=[]}if(a=a.concat(e.utf8),i.length-1===o){const e=a.join(n);t=t.concat({...s,segs:e})}return t}),[])}));window.addEventListener("message",(({data:t})=>{if("web"===t.source&&"requestSubtitleResponse"===t.type){const e=new URL(t.text);subtitleRequestXhrUrl=t.text,e.searchParams.delete("fmt"),chrome.storage.sync.get(["single","langCode","dualSubtitlesStyle","singleSubtitleStyle","customStyle"],(({single:t,langCode:a,dualSubtitlesStyle:r,singleSubtitleStyle:s,customStyle:l})=>{const c=standardCode(e.searchParams.get("lang")),p=({one:t})=>{document.querySelector("#customSubtitleStyle").textContent=`\n            #ytp-caption-window-container .caption-window:not([lang]) .captions-text { display: inline-grid !important; background: transparent !important; }\n            #inline-preview-player #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line .ytp-caption-segment,\n            .miniplayer.ytd-miniplayer #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line .ytp-caption-segment { --ytScalingRatio: 0.5625;}\n            #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line .ytp-caption-segment {\n              font-family: ${t.fontFamily} !important;\n              font-size: calc(${t.fontSize}px * var(--ytScalingRatio)) !important;\n              color: ${t.color} !important;\n              background: ${t.background} !important;\n              text-shadow:${[...Array(14)].map((()=>`0 0 3px ${t.textStroke}`))} !important;\n            }\n            ${i}\n            `};if(a===c)n=!0,errorBackHandler(!1),l?p(s):document.querySelector("#customSubtitleStyle").textContent="\n              #ytp-caption-window-container .caption-window:not([lang]) .captions-text { display: inline-grid !important; }";else if(t){n=!0,l?p(s):document.querySelector("#customSubtitleStyle").textContent="\n                #ytp-caption-window-container .caption-window:not([lang]) .captions-text { display: inline-grid !important; }";const t=()=>{e.searchParams.set("tlang",a);const t=e.toString();o(t,a).then((t=>{const n={wireMagic:"pb3",pens:[{}],wsWinStyles:[{}],wpWinPositions:[{}],events:t.reduce(((t,n)=>n.segs.trim()?t.concat({...n,segs:[{utf8:`${n.segs}`}]}):t),[])};window.postMessage({source:"ext",type:"responseSubtitleResponse",text:JSON.stringify(n)})})).catch((()=>errorBackHandler(2)))};requestSubtitleList(e.searchParams.get("v")).then((({captions:n})=>{const e=n.playerCaptionsTracklistRenderer.captionTracks.find((t=>a===standardCode(t.languageCode)&&!t.kind));e?o(e.baseUrl,a).then((t=>{const n={wireMagic:"pb3",pens:[{}],wsWinStyles:[{}],wpWinPositions:[{}],events:t.reduce(((t,n)=>n.segs.trim()?t.concat({...n,segs:[{utf8:`${n.segs}`}]}):t),[])};window.postMessage({source:"ext",type:"responseSubtitleResponse",text:JSON.stringify(n)}),document.querySelector("#dualMarkStyle").disabled=!1})).catch((()=>errorBackHandler(1))):(t(),document.querySelector("#dualMarkStyle").disabled=!0)})).catch((()=>{t()}))}else{if(n=!1,l){const{one:t,two:n,rowGap:e}=r;document.querySelector("#customSubtitleStyle").textContent=`\n                #ytp-caption-window-container .caption-window:not([lang]) .captions-text { display: inline-grid !important; row-gap: ${e}px !important; background: transparent !important; }\n                #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(1) { grid-row-start: ${t.rowStart} !important; text-align: center !important; }\n                #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(2) { grid-row-start: ${n.rowStart} !important; text-align: center !important; }\n                #inline-preview-player #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line .ytp-caption-segment,\n                .miniplayer.ytd-miniplayer #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line .ytp-caption-segment {--ytScalingRatio: 0.5625;}\n                #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(1) .ytp-caption-segment {\n                  font-family: ${t.fontFamily} !important;\n                  font-size: calc(${t.fontSize}px * var(--ytScalingRatio)) !important;\n                  color: ${t.color} !important;\n                  background: ${t.background} !important;\n                  text-shadow:${[...Array(14)].map((()=>`0 0 3px ${t.textStroke}`))} !important;\n                }\n                #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(2) .ytp-caption-segment {\n                  font-family: ${n.fontFamily} !important;\n                  font-size: calc(${n.fontSize}px * var(--ytScalingRatio)) !important;\n                  color: ${n.color} !important;\n                  background: ${n.background} !important;\n                  text-shadow:${[...Array(14)].map((()=>`0 0 3px ${n.textStroke}`))} !important;\n                }\n                ${i}\n                `}else{const{one:t,two:n,rowGap:e}=r;document.querySelector("#customSubtitleStyle").textContent=`\n                #ytp-caption-window-container .caption-window:not([lang]) .captions-text { display: inline-grid !important; row-gap: ${e}px !important; }\n                #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(1) { grid-row-start: ${t.rowStart} !important; text-align: center !important; }\n                #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(2) { grid-row-start: ${n.rowStart} !important; text-align: center !important; }\n                `}const t=e.toString();e.searchParams.set("tlang",a);const s=e.toString(),p=()=>{Promise.all([o(t,c),o(s,a)]).then((([t,n])=>{const e={wireMagic:"pb3",pens:[{}],wsWinStyles:[{}],wpWinPositions:[{}],events:t.reduce(((t,e,o)=>e.segs.trim()||n[o].segs.trim()?t.concat({...e,segs:[{utf8:`${e.segs}\n${n[o].segs}`}]}):t),[])};window.postMessage({source:"ext",type:"responseSubtitleResponse",text:JSON.stringify(e)})})).catch((()=>errorBackHandler(2)))};requestSubtitleList(e.searchParams.get("v")).then((async({captions:n})=>{const e=n.playerCaptionsTracklistRenderer.captionTracks.find((t=>a===standardCode(t.languageCode)&&!t.kind));e?Promise.all([o(t,c),o(e.baseUrl,a)]).then((([t,n])=>{if(t.length===n.length){const e={wireMagic:"pb3",pens:[{}],wsWinStyles:[{}],wpWinPositions:[{}],events:t.reduce(((t,e,o)=>e.segs.trim()||n[o].segs.trim()?t.concat({...e,segs:[{utf8:`${e.segs}\n${n[o].segs}`}]}):t),[])};window.postMessage({source:"ext",type:"responseSubtitleResponse",text:JSON.stringify(e)}),document.querySelector("#dualMarkStyle").disabled=!1}else document.querySelector("#dualMarkStyle").disabled=!0,o(s,a).then((n=>{const e={wireMagic:"pb3",pens:[{}],wsWinStyles:[{}],wpWinPositions:[{}],events:t.reduce(((t,e,o)=>e.segs.trim()||n[o].segs.trim()?t.concat({...e,segs:[{utf8:`${e.segs}\n${n[o].segs}`}]}):t),[])};window.postMessage({source:"ext",type:"responseSubtitleResponse",text:JSON.stringify(e)})})).catch((()=>errorBackHandler(2)))})).catch((()=>errorBackHandler(2))):(document.querySelector("#dualMarkStyle").disabled=!0,p())})).catch((()=>{document.querySelector("#dualMarkStyle").disabled=!0,p()}))}}))}}));const a=document.createElement("script");return a.textContent='{const e=XMLHttpRequest.prototype.open,t=XMLHttpRequest.prototype.send,s=function(){arguments[1].includes("api/timedtext")&&(this._url=arguments[1]),e.apply(this,arguments)},o=function(){if(this._url){window.postMessage({source:"web",type:"requestSubtitleResponse",text:this._url});const e=({data:s})=>{"ext"===s.source&&"responseSubtitleResponse"===s.type&&(s.text&&Object.defineProperty(this,"responseText",{value:s.text,writable:!1}),t.apply(this,arguments),window.removeEventListener("message",e))};window.addEventListener("message",e)}else t.apply(this,arguments)};window.addEventListener("message",(({data:e})=>{if("ext"===e.source){const t=window.location.pathname.includes("/embed/")?"#player":"#ytd-player",s=document.querySelector(`${t} .html5-video-player`);switch(e.type){case"requestTranslationList":const e=s.getOption("captions","translationLanguages");window.postMessage({source:"web",type:"responseTranslationList",text:e});break;case"openSubtitle":s.toggleSubtitles();break;case"restartSubtitles":s.setOption("captions","reload",!0);break;case"onQualityChange":setTimeout((()=>{const e=s.getPreferredQuality();window.postMessage({source:"web",type:"responseQuality",text:e})}),300)}}})),Object.defineProperty(XMLHttpRequest.prototype,"open",{value:s,writable:!1}),Object.defineProperty(XMLHttpRequest.prototype,"send",{value:o,writable:!1})}',(document.head||document.documentElement).append(a),a.remove(),chrome.runtime.sendMessage({type:"recovery"}),o})();chrome.storage.local.onChanged.addListener((({singleSubtitleStyle:t,dualSubtitlesStyle:e,customStyle:o,requestSameLang:a})=>{const r=t=>{const{one:n}=t;document.querySelector("#customSubtitleStyle").textContent=`\n    #ytp-caption-window-container .caption-window:not([lang]) .captions-text { display: inline-grid !important; background: transparent !important; }\n    #inline-preview-player #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line .ytp-caption-segment,\n    .miniplayer.ytd-miniplayer #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line .ytp-caption-segment {--ytScalingRatio: 0.5625;}\n    #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line .ytp-caption-segment {\n      font-family: ${n.fontFamily} !important;\n      font-size: calc(${n.fontSize}px * var(--ytScalingRatio)) !important;\n      color: ${n.color} !important;\n      background: ${n.background} !important;\n      text-shadow:${[...Array(14)].map((()=>`0 0 3px ${n.textStroke}`))} !important;\n    }\n    ${i}\n    `},s=t=>{const{one:n,two:e,rowGap:o}=t;document.querySelector("#customSubtitleStyle").textContent=`\n    #ytp-caption-window-container .caption-window:not([lang]) .captions-text { display: inline-grid !important; row-gap: ${o}px !important; background: transparent !important; }\n    #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(1) { grid-row-start: ${n.rowStart} !important; text-align: center !important; }\n    #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(2) { grid-row-start: ${e.rowStart} !important; text-align: center !important; }\n    #inline-preview-player #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line .ytp-caption-segment,\n    .miniplayer.ytd-miniplayer #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line .ytp-caption-segment {--ytScalingRatio: 0.5625;}\n    #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(1) .ytp-caption-segment {\n      font-family: ${n.fontFamily} !important;\n      font-size: calc(${n.fontSize}px * var(--ytScalingRatio)) !important;\n      color: ${n.color} !important;\n      background: ${n.background} !important;\n      text-shadow:${[...Array(14)].map((()=>`0 0 3px ${n.textStroke}`))} !important;\n    }\n    #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(2) .ytp-caption-segment {\n      font-family: ${e.fontFamily} !important;\n      font-size: calc(${e.fontSize}px * var(--ytScalingRatio)) !important;\n      color: ${e.color} !important;\n      background: ${e.background} !important;\n      text-shadow:${[...Array(14)].map((()=>`0 0 3px ${e.textStroke}`))} !important;\n    }\n    ${i}\n    `};o&&chrome.storage.sync.get(["dualSubtitlesStyle","singleSubtitleStyle","single"],(({dualSubtitlesStyle:t,singleSubtitleStyle:e,single:i})=>{if(o.newValue)n||i?r(e):s(t);else if(n||i)document.querySelector("#customSubtitleStyle").textContent="\n            #ytp-caption-window-container .caption-window:not([lang]) .captions-text { display: inline-grid !important; }";else{const{one:n,two:e,rowGap:o}=t;document.querySelector("#customSubtitleStyle").textContent=`\n            #ytp-caption-window-container .caption-window:not([lang]) .captions-text { display: inline-grid !important; row-gap: ${o}px !important; }\n            #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(1) { grid-row-start: ${n.rowStart} !important; text-align: center !important; }\n            #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(2) { grid-row-start: ${e.rowStart} !important; text-align: center !important; }\n            `}})),t&&n&&chrome.storage.sync.get("customStyle",(({customStyle:n})=>{n&&r(t.newValue)})),e&&!n&&chrome.storage.sync.get("customStyle",(({customStyle:t})=>{if(t)s(e.newValue);else{const{one:t,two:n,rowGap:o}=e.newValue;document.querySelector("#customSubtitleStyle").textContent=`\n        #ytp-caption-window-container .caption-window:not([lang]) .captions-text { display: inline-grid !important; row-gap: ${o}px !important; }\n        #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(1) { grid-row-start: ${t.rowStart} !important; text-align: center !important; }\n        #ytp-caption-window-container .caption-window:not([lang]) .caption-visual-line:nth-of-type(2) { grid-row-start: ${n.rowStart} !important; text-align: center !important; }\n        `}})),a&&chrome.runtime.sendMessage({type:"requestSameLang",value:n})}));